<% const title='Products' ; const body=` <div class="container-fluid py-4">
    <div class="row g-4">
        <!-- Sidebar Filters -->
        <aside class="col-lg-3">
            <form action="/products" method="GET" id="filterForm">
                ${searchQuery ? `<input type="hidden" name="search" value="${searchQuery}">` : ''}

                <!-- Category Filter -->
                <div class="card mb-3">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Category</h5>
                    </div>
                    <div class="card-body">
                        ${categories.map(cat => `
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="category" value="${cat}"
                                id="cat-${cat}" ${selectedCategories.includes(cat) ? 'checked' : '' }
                                onchange="document.getElementById('filterForm').submit()">
                            <label class="form-check-label" for="cat-${cat}">
                                ${cat}
                            </label>
                        </div>
                        `).join('')}
                    </div>
                </div>

                <!-- Color Filter -->
                <div class="card mb-3">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Color</h5>
                    </div>
                    <div class="card-body">
                        ${colors.map(color => `
                        <div class="form-check mb-2">
                            <input class="form-check-input" type="checkbox" name="color" value="${color}"
                                id="color-${color}" ${selectedColors.includes(color) ? 'checked' : '' }
                                onchange="document.getElementById('filterForm').submit()">
                            <label class="form-check-label" for="color-${color}">
                                ${color}
                            </label>
                        </div>
                        `).join('')}
                    </div>
                </div>

                <a href="/products" class="btn btn-outline-primary w-100">Clear Filters</a>
            </form>
        </aside>

        <!-- Products Grid -->
        <main class="col-lg-9">
            <div class="mb-4">
                <h1 class="h2 text-deep-navy">Our Products</h1>
                <p class="text-muted">${products.length} product${products.length !== 1 ? 's' : ''} found</p>
            </div>

            ${products.length > 0 ? `
            <div class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-4">
                ${products.map(product => `
                <div class="col">
                    <a href="/products/${product.slug}" class="text-decoration-none">
                        <div class="card h-100 bg-chipmunk-tan border-0 shadow-sm hover-lift">
                            <img src="${product.imgUrl}" class="card-img-top" alt="${product.name}"
                                style="height: 200px; object-fit: cover;">
                            <div class="card-body">
                                <p class="text-uppercase small text-muted mb-1">${product.category}</p>
                                <h5 class="card-title text-deep-navy">${product.name}</h5>
                                <p class="h4 text-fez-red fw-bold mb-2">${product.price.toFixed(2)} MAD</p>
                                <span class="badge bg-deep-navy">${product.color}</span>
                            </div>
                        </div>
                    </a>
                </div>
                `).join('')}
            </div>
            ` : `
            <div class="text-center py-5">
                <h3 class="text-muted">No products found</h3>
                <p>Try adjusting your filters or search query</p>
            </div>
            `}
        </main>
    </div>
    </div>
    `;
    %>
    <%- include('layout', { title, body }) %>